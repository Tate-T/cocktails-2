{"version":3,"file":"favorites-app-940c27e2.js","sources":["../../src/js/favorites-app.js"],"sourcesContent":["import { CocktailAPI } from './API/api.js';\nimport { CocktailComponents } from './components/renderCoctails.js';\nimport { Favorites } from './utils/favorites.js';\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  const container = document.querySelector('.favorite-coctails__list');\n  const pretitle = document.querySelector('.favorite-coctails__pretitle');\n\n  const favoriteIds = Favorites.getFavorites();\n  \n  if (favoriteIds.length === 0) {\n    pretitle.style.display = 'block';\n    return;\n  }\n\n  try {\n    const drinks = await loadFavoriteDrinks(favoriteIds);\n    CocktailComponents.renderFavoritesList(container, drinks);\n    pretitle.style.display = 'none';\n    setupGlobalListeners();\n  } catch (error) {\n    handleFavoriteError(error);\n  }\n});\n\nasync function loadFavoriteDrinks(ids) {\n  const requests = ids.map(id => CocktailAPI.fetchCocktailById(id));\n  const responses = await Promise.all(requests);\n  return responses\n    .filter(response => response?.drinks?.[0])\n    .map(response => response.drinks[0]);\n}\n\nfunction setupGlobalListeners() {\n  document.addEventListener('click', event => {\n    handleLearnMoreClick(event);\n    handleFavoriteClick(event);\n  });\n}\n\nasync function handleLearnMoreClick(event) {\n  const learnMoreBtn = event.target.closest('.js-learn-more');\n  if (!learnMoreBtn) return;\n\n  const cocktailItem = learnMoreBtn.closest('[data-id]');\n  const cocktailId = cocktailItem.dataset.id;\n\n  try {\n    const data = await CocktailAPI.fetchCocktailById(cocktailId);\n    const modalHtml = CocktailComponents.renderModal(data.drinks[0]);\n    \n    document.querySelectorAll(\".cocktails-modal__backdrop\").forEach(m => m.remove());\n    document.body.insertAdjacentHTML(\"beforeend\", modalHtml);\n    setupModal(cocktailId);\n  } catch (error) {\n    console.error(\"Failed to fetch cocktail details:\", error);\n  }\n}\n\nfunction handleFavoriteClick(event) {\n  const favoriteBtn = event.target.closest('.js-favorite');\n  if (!favoriteBtn) return;\n\n  const cocktailItem = favoriteBtn.closest('[data-id]');\n  const cocktailId = cocktailItem.dataset.id;\n  \n  toggleFavorite(cocktailId, favoriteBtn);\n  \n  if (!Favorites.isFavorite(cocktailId)) {\n    const itemToRemove = document.querySelector(`\n      .favorite-coctails__list [data-id=\"${cocktailId}\"]\n    `);\n    itemToRemove?.remove();\n    \n    const hasItems = !!document.querySelector('.favorite-coctails__list li');\n    document.querySelector('.favorite-coctails__pretitle').style.display = \n      hasItems ? 'none' : 'block';\n  }\n}\n\nfunction setupModal(cocktailId) { \n  const backdrop = document.querySelector(\".cocktails-modal__backdrop\");\n  if (!backdrop) return;\n\n  setTimeout(() => backdrop.classList.add(\"is-visible\"), 10);\n\n  const closeModal = () => {\n    backdrop.classList.remove(\"is-visible\");\n    setTimeout(() => backdrop.remove(), 300);\n  };\n\n  backdrop.querySelector(\".js-modal-close\")?.addEventListener(\"click\", closeModal);\n  backdrop.addEventListener(\"click\", (e) => e.target === backdrop && closeModal());\n\n  const modalFavoriteBtn = backdrop.querySelector(\".js-favorite\");\n  modalFavoriteBtn?.addEventListener(\"click\", () => toggleFavorite(cocktailId, modalFavoriteBtn));\n}\n\nfunction toggleFavorite(id, button) {\n  const isFavorite = Favorites.isFavorite(id);\n  const newState = !isFavorite;\n\n  newState ? Favorites.addFavorite(id) : Favorites.removeFavorite(id);\n\n  button.classList.toggle(\"is-active\", newState);\n  updateButtonUI(button, newState);\n\n  document.querySelectorAll(`[data-id=\"${id}\"] .js-favorite`).forEach(btn => {\n    if (btn !== button) {\n      btn.classList.toggle(\"is-active\", newState);\n      updateButtonUI(btn, newState);\n    }\n  });\n}\n\nfunction updateButtonUI(button, isActive) {\n  const textElement = button.querySelector(\".cocktails__favorite-title\") || button;\n  const isModal = button.classList.contains(\"cocktails-modal__favorite-button\");\n\n  textElement.textContent = isActive\n    ? (isModal ? \"Remove from favorite\" : \"Remove\")\n    : (isModal ? \"Add to favorite\" : \"Add to\");\n}\n\nfunction handleFavoriteError(error) {\n  console.error('Error loading favorites:', error);\n  document.querySelector('.favorite-coctails__pretitle').textContent = \n    'Failed to load favorite cocktails';\n  document.querySelector('.favorite-coctails__pretitle').style.display = 'block';\n}"],"names":["container","pretitle","favoriteIds","Favorites","drinks","loadFavoriteDrinks","CocktailComponents","setupGlobalListeners","error","handleFavoriteError","ids","requests","id","CocktailAPI","response","_a","event","handleLearnMoreClick","handleFavoriteClick","learnMoreBtn","cocktailId","data","modalHtml","m","setupModal","favoriteBtn","toggleFavorite","itemToRemove","hasItems","backdrop","closeModal","e","modalFavoriteBtn","button","newState","updateButtonUI","btn","isActive","textElement","isModal"],"mappings":"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"}