{"version":3,"file":"favorites-app-f56a7828.js","sources":["../../src/js/favorites-app.js"],"sourcesContent":["import { CocktailAPI } from './API/api.js';\r\nimport { CocktailComponents } from './components/renderCoctails.js';\r\nimport { Favorites } from './utils/favorites.js';\r\n\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n  const container = document.querySelector('.favorite-coctails__list');\r\n  const pretitle = document.querySelector('.favorite-coctails__pretitle');\r\n\r\n  const favoriteIds = Favorites.getFavorites();\r\n  \r\n  if (favoriteIds.length === 0) {\r\n    pretitle.style.display = 'block';\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const drinks = await loadFavoriteDrinks(favoriteIds);\r\n    CocktailComponents.renderFavoritesList(container, drinks);\r\n    pretitle.style.display = 'none';\r\n    setupGlobalListeners();\r\n  } catch (error) {\r\n    handleFavoriteError(error);\r\n  }\r\n});\r\n\r\nasync function loadFavoriteDrinks(ids) {\r\n  const requests = ids.map(id => CocktailAPI.fetchCocktailById(id));\r\n  const responses = await Promise.all(requests);\r\n  return responses\r\n    .filter(response => response?.drinks?.[0])\r\n    .map(response => response.drinks[0]);\r\n}\r\n\r\nfunction setupGlobalListeners() {\r\n  document.addEventListener('click', event => {\r\n    handleLearnMoreClick(event);\r\n    handleFavoriteClick(event);\r\n  });\r\n}\r\n\r\nasync function handleLearnMoreClick(event) {\r\n  const learnMoreBtn = event.target.closest('.js-learn-more');\r\n  if (!learnMoreBtn) return;\r\n\r\n  const cocktailItem = learnMoreBtn.closest('[data-id]');\r\n  const cocktailId = cocktailItem.dataset.id;\r\n\r\n  try {\r\n    const data = await CocktailAPI.fetchCocktailById(cocktailId);\r\n    const modalHtml = CocktailComponents.renderModal(data.drinks[0]);\r\n    \r\n    document.querySelectorAll(\".cocktails-modal__backdrop\").forEach(m => m.remove());\r\n    document.body.insertAdjacentHTML(\"beforeend\", modalHtml);\r\n    setupModal(cocktailId);\r\n  } catch (error) {\r\n    console.error(\"Failed to fetch cocktail details:\", error);\r\n  }\r\n}\r\n\r\nfunction handleFavoriteClick(event) {\r\n  const favoriteBtn = event.target.closest('.js-favorite');\r\n  if (!favoriteBtn) return;\r\n\r\n  const cocktailItem = favoriteBtn.closest('[data-id]');\r\n  const cocktailId = cocktailItem.dataset.id;\r\n  \r\n  toggleFavorite(cocktailId, favoriteBtn);\r\n  \r\n  if (!Favorites.isFavorite(cocktailId)) {\r\n    const itemToRemove = document.querySelector(`\r\n      .favorite-coctails__list [data-id=\"${cocktailId}\"]\r\n    `);\r\n    itemToRemove?.remove();\r\n    \r\n    const hasItems = !!document.querySelector('.favorite-coctails__list li');\r\n    document.querySelector('.favorite-coctails__pretitle').style.display = \r\n      hasItems ? 'none' : 'block';\r\n  }\r\n}\r\n\r\nfunction setupModal(cocktailId) { \r\n  const backdrop = document.querySelector(\".cocktails-modal__backdrop\");\r\n  if (!backdrop) return;\r\n\r\n  setTimeout(() => backdrop.classList.add(\"is-visible\"), 10);\r\n\r\n  const closeModal = () => {\r\n    backdrop.classList.remove(\"is-visible\");\r\n    setTimeout(() => backdrop.remove(), 300);\r\n  };\r\n\r\n  backdrop.querySelector(\".js-modal-close\")?.addEventListener(\"click\", closeModal);\r\n  backdrop.addEventListener(\"click\", (e) => e.target === backdrop && closeModal());\r\n\r\n  const modalFavoriteBtn = backdrop.querySelector(\".js-favorite\");\r\n  modalFavoriteBtn?.addEventListener(\"click\", () => toggleFavorite(cocktailId, modalFavoriteBtn));\r\n}\r\n\r\nfunction toggleFavorite(id, button) {\r\n  const isFavorite = Favorites.isFavorite(id);\r\n  const newState = !isFavorite;\r\n\r\n  newState ? Favorites.addFavorite(id) : Favorites.removeFavorite(id);\r\n\r\n  button.classList.toggle(\"is-active\", newState);\r\n  updateButtonUI(button, newState);\r\n\r\n  document.querySelectorAll(`[data-id=\"${id}\"] .js-favorite`).forEach(btn => {\r\n    if (btn !== button) {\r\n      btn.classList.toggle(\"is-active\", newState);\r\n      updateButtonUI(btn, newState);\r\n    }\r\n  });\r\n}\r\n\r\nfunction updateButtonUI(button, isActive) {\r\n  const textElement = button.querySelector(\".cocktails__favorite-title\") || button;\r\n  const isModal = button.classList.contains(\"cocktails-modal__favorite-button\");\r\n\r\n  textElement.textContent = isActive\r\n    ? (isModal ? \"Remove from favorite\" : \"Remove\")\r\n    : (isModal ? \"Add to favorite\" : \"Add to\");\r\n}\r\n\r\nfunction handleFavoriteError(error) {\r\n  console.error('Error loading favorites:', error);\r\n  document.querySelector('.favorite-coctails__pretitle').textContent = \r\n    'Failed to load favorite cocktails';\r\n  document.querySelector('.favorite-coctails__pretitle').style.display = 'block';\r\n}"],"names":["container","pretitle","favoriteIds","Favorites","drinks","loadFavoriteDrinks","CocktailComponents","setupGlobalListeners","error","handleFavoriteError","ids","requests","id","CocktailAPI","response","_a","event","handleLearnMoreClick","handleFavoriteClick","learnMoreBtn","cocktailId","data","modalHtml","m","setupModal","favoriteBtn","toggleFavorite","itemToRemove","hasItems","backdrop","closeModal","e","modalFavoriteBtn","button","newState","updateButtonUI","btn","isActive","textElement","isModal"],"mappings":"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"}